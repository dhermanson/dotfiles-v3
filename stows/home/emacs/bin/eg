#!/bin/bash

tempfile=$(mktemp "/tmp/grepresult.XXXXXXXXXX")
rg --hidden \
  --glob "!TAGS" \
  --vimgrep "$@" > $tempfile

rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
  
emacsclient --eval "(kill-matching-buffers \"\\\\.grep\\\\..*\" t t) " 2>&1 > /dev/null

ec $tempfile
